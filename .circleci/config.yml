version: 2.1

parameters:
  api:
    type: boolean
    default: false

references:

  ## Workspace

  workspace: &workspace
    ~/project

executors:
  android_executor:
    working_directory: *workspace
    docker:
      - image: circleci/android:api-29
    environment:
      JVM_OPTS: -Xmx3200m
      GRADLE_OPTS: -Dorg.gradle.caching=true -Dorg.gradle.parallel=true -Dorg.gradle.jvmargs="-Xmx4g -Xms1g"

orbs:
  sample-orb: jdroid/sample-orb@dev:alpha

jobs:

  a1:
    executor: android_executor
    steps:
      - checkout
      - run:
          name: "Assemble app"
          command: ./gradlew assemble
      - sample-orb/verify_gradle_wrapper
      - run:
          name: "Gradle version"
          command: ./gradlew --version
      - sample-orb/inspect_gradle_cache
      - sample-orb/clean_gradle_cache


workflows:
  commit:
    jobs:
      - a1